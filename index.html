<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Audio Sync Demo</title>
  <style>
    body {
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      background-color: black;
      color: white; /* 全体の文字色を白に */
      height: 100vh; /* ビューポート全体の高さ */
      overflow: hidden; /* ページがスクロールしないように */
    }

    .content {
      margin-top: 20px;
      text-align: center;
    }

    p {
      color: white; /* 状態メッセージの文字色 */
    }

    button {
      background-color: rgb(227, 227, 227); /* ボタンの背景色を不透明の白に */
      color: black; /* ボタンの文字色を黒に */
      border: none; /* ボーダーを削除 */
      padding: 10px 20px;
      width: 66.67vw; /* ボタンの横幅を端末の横幅の3分の2に設定 */
      max-width: 400px; /* ボタンの最大幅を400pxに制限 */
      border-radius: 10px;
      font-size: 22px;
      cursor: pointer;
      text-align: center;
      transition: background-color 0.3s; /* 色変更時のスムーズな遷移 */
    }

    button:active {
      background-color: #727272; /* ボタンを押したときの色 */
    }

    button.clicked {
      background-color: #696969; /* ボタンがクリック済みの場合の色 */
      color: gray; /* クリック済みの文字色 */
      cursor: not-allowed; /* カーソルを変更 */
    }
  </style>
</head>
<body>
  <div class="content">
    <p id="status">同期中...</p>
  </div>
  <button id="start-button">デモに参加する</button>
  <audio id="audio" preload="auto" src="your-audio-file.mp3"></audio>

  <script>
    // 再生開始時刻（例: 17:30:00）
    const targetTime = new Date();
    targetTime.setHours(18, 35, 0, 0); // 今日の17時30分00秒

    const audio = document.getElementById('audio');
    const startButton = document.getElementById('start-button');
    const status = document.getElementById('status');

    // ボタンをクリックしたときに再生許可を得る
    startButton.addEventListener('click', async () => {
      try {
        await audio.play();
        audio.pause(); // 再生を即停止して権限だけ取得
        alert('Audio playback authorized. Waiting for the target time.');
        startButton.style.display = 'none'; // ボタンを非表示
        startButton.classList.add('clicked'); // ボタンがクリック済みの状態にする
        startButton.textContent = 'デモが有効化されました'; // ボタンのテキストを変更
      } catch (error) {
        alert('Failed to authorize audio playback: ' + error);
      }
    });

    // 時刻同期チェック
    function syncAudioPlayback() {
      const now = new Date();
      const delay = targetTime - now;

      if (delay <= 0) {
        audio.play().catch((error) => {
          console.error('Playback failed:', error);
        });
        clearInterval(intervalId); // タイマーをクリア
        status.textContent = '再生中';
      }
    }

    // 1秒ごとに再生タイミングを確認
    const intervalId = setInterval(syncAudioPlayback, 1000);
  </script>
</body>
</html>
